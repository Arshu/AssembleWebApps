(function(n){function t(n,t,i,r){this.enabled=!0;this.sourceType=n;this.source=t;i!==null&&(i=i.replace(/\?/g,"[a-z0-9_-]+").replace(/\*/g,"[a-z0-9_-]+(.[a-z0-9_-]+)*").replace(/\./g,"\\."),i=new RegExp("^"+i+"$","i"));this.name=i;this.callback=r}function r(n,t,i){this.source=n;this.name=t;this.args=i||{};this.handled=!1}function i(){this.events=[];this.filters=[]}t.prototype.enable=function(){this.enabled=!0};t.prototype.disable=function(){this.enabled=!1};t.prototype.tryInvoke=function(n,t,i){return!this.enabled||this.sourceType!==null&&!(n instanceof this.sourceType)||this.source!==null&&this.source!=n||this.name!==null&&!this.name.exec(t)?i:this.callback(i)};r.prototype.handled=function(){this.handled=!0};r.prototype.isHandled=function(){return this.handled};i.prototype={registerEventHandler:function(n,i,r,u){var f=new t(n,i,r,u);return this.events.push(f),f},observeType:function(n,t){this.registerEventHandler(n,null,null,t)},observeObject:function(n,t){this.registerEventHandler(null,n,null,t)},observeEvent:function(n,t){this.registerEventHandler(null,null,n,t)},registerFilter:function(n,i){var r=new t(null,null,n,i);return this.filters.push(r),r},fire:function(n,t,i){for(var f=new r(n,t,i),u=0,e=this.events.length;u<e;u++)if(this.events[u].tryInvoke(n,t,f),f.isHandled())break},filter:function(n,t){for(var i=0,r=this.filters.length;i<r;i++)t=this.filters[i].tryInvoke(null,n,t);return t}};i.mixin=function(t,i){i=i||n.arshulink;t.fire=function(n,t){i.fire(this,n,t||{})};t.filter=function(n,t){return i.filter(n,t||{})}};n.ArshuLink=i;n.arshulink=new i})(this);